(function(){var n,r;n=function(){function n(n){"function"==typeof n&&this.draw(n)}var r,t,e;return e=function(n){var r,t,e,a;return r=/:([\w\d]+)/g,t="([^/]+)",e=/\*([\w\d]+)/g,a="(.*)",n=n.replace(r,t).replace(e,a),RegExp("^"+n+"$","gi")},r=function(n){var r,t,e,a;for(t=/[:|\*]([\w\d]+)/g,a=[];r=t.exec(n);)a.push(e=r[1]);return a},t=function(n){var r,t,e;if(t={},null!=n)for(e=/[\?&]([^=&]+)=?([^&$]+)?/g;r=e.exec(n);)t[r[1]]=r[2];return t},n.prototype.draw=function(n){return n.call(this)},n.prototype.map=function(n,r){var t;if(null==(t=this.mappings)&&(this.mappings=[]),"string"!=typeof n)throw Error("route must be a string");if("function"!=typeof r)throw Error("callback must be a function");return this.mappings.push({route:n,callback:r})},n.prototype.match=function(n,r){var t,e,a,o,u,i,l,p,c;for(p=this.mappings,c=[],i=0,l=p.length;l>i;i++){if(e=p[i],a=this.scan(n,e.route)){if(null!=r){o=r.params,delete r.params;for(t in r)u=r[t],a[t]=u;if(null!=o&&null==a.params)a.params=o;else for(t in o)u=o[t],a.params[t]=u}e.callback(a);break}c.push(void 0)}return c},n.prototype.matchLocation=function(n){var r,e,a;null==n&&(n=window.location),e={},null!=n.search&&(e.params=t(n.search));for(r in n)a=n[r],e[r]=a;return this.match(n.pathname,e)},n.prototype.scan=function(n,t,a){var o,u,i,l,p,c,f,s,h;if(null!=a&&null!=a.regexp?f=a.regexp:(f=e(t),null!=a&&(a.regexp=f)),o=f.exec(n),null==o)return!1;for(p=r(t),c={},o.shift(),u=s=0,h=p.length;h>s;u=++s)l=p[u],c[l]=o[u];return i={params:c}},n.prototype.namespace=function(n,r){var t,e;return e=this,t={map:function(r,t){return e.map(n+r,t)}},r.call(t)},n}(),r!==void 0&&null!==r?("undefined"!=typeof module&&null!==module&&null!=module.exports&&(r=module.exports=n),r.Cartograph=n):"function"==typeof define&&define.amd?define(function(){return n}):this.Cartograph=n}).call(this);