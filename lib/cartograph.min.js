(function(){var n,t;n=function(){function n(n){"function"==typeof n&&this.draw(n)}var t,r,e,a,o,i,u,p;return e=/:([\w\d]+)/g,a="([^/]+)",u=/\*([\w\d]+)/g,p="(.*)",r=/[:|\*]([\w\d]+)/g,i=function(n){return n=n.replace(e,a).replace(u,p),RegExp("^"+n+"$","gi")},t=function(n){var t,e,a;for(a=[];t=r.exec(n);)a.push(e=t[1]);return a},o=function(n){var t,r,e;if(r={},null!=n)for(e=/[\?&]([^=&]+)=?([^&$]+)?/g;t=e.exec(n);)r[t[1]]=t[2];return r},n.prototype.draw=function(n){return n.call(this)},n.prototype.map=function(n,t){var r;if(null==(r=this.mappings)&&(this.mappings=[]),"string"!=typeof n)throw Error("route must be a string");if("function"!=typeof t)throw Error("callback must be a function");return this.mappings.push({route:n,callback:t})},n.prototype.match=function(n,t){var r,e,a,o,i,u,p,l,c;for(l=this.mappings,c=[],u=0,p=l.length;p>u;u++){if(e=l[u],a=this.scan(n,e.route)){if(null!=t){o=t.params,delete t.params;for(r in t)i=t[r],a[r]=i;if(null!=o&&null==a.params)a.params=o;else for(r in o)i=o[r],a.params[r]=i}e.callback(a);break}c.push(void 0)}return c},n.prototype.matchLocation=function(n){var t,r,e;null==n&&(n=window.location),r={},null!=n.search&&(r.params=o(n.search));for(t in n)e=n[t],r[t]=e;return this.match(n.pathname,r)},n.prototype.scan=function(n,r){var e,a,o,u,p,l,c,f,s;if(c=i(r),e=c.exec(n),null==e)return!1;for(p=t(r),l={},e.shift(),a=f=0,s=p.length;s>f;a=++f)u=p[a],l[u]=e[a];return o={params:l}},n.prototype.namespace=function(n,t){var r,e;return e=this,r={map:function(t,r){return e.map(n+t,r)}},t.call(r)},n}(),t!==void 0&&null!==t?("undefined"!=typeof module&&null!==module&&null!=module.exports&&(t=module.exports=n),t.Cartograph=n):"function"==typeof define&&define.amd?define(function(){return n}):this.Cartograph=n}).call(this);