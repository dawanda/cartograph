(function(){var r,t;r=function(){function r(r){"function"==typeof r&&this.draw(r)}var t,n,e,a,o,i,u,p;return e=/:([\w\d]+)/g,a="([^/]+)",u=/\*([\w\d]+)/g,p="(.*)",n=/[:|\*]([\w\d]+)/g,i=function(r){return r=r.replace(e,a).replace(u,p),RegExp("^"+r+"$","gi")},t=function(r){var t,e,a;for(a=[];t=n.exec(r);)a.push(e=t[1]);return a},o=function(r){var t,n,e;if(n={},null!=r)for(e=/[\?&]([^=&]+)=?([^&$]+)?/g;t=e.exec(r);)n[t[1]]=t[2];return n},r.prototype.draw=function(r){return r.call(this)},r.prototype.map=function(r,t){var n;if(null==(n=this.mappings)&&(this.mappings=[]),"string"!=typeof r)throw Error("route must be a string");if("function"!=typeof t)throw Error("callback must be a function");return this.mappings.push({route:r,callback:t})},r.prototype.match=function(r,t){var n,e,a,o,i,u,p,f,c;for(f=this.mappings,c=[],u=0,p=f.length;p>u;u++){if(e=f[u],a=this.scan(r,e.route)){if(null!=t){o=t.params,delete t.params;for(n in t)i=t[n],a[n]=i;if(null!=o&&null==a.params)a.params=o;else for(n in o)i=o[n],a.params[n]=i}e.callback(a);break}c.push(void 0)}return c},r.prototype.matchLocation=function(r){var t,n,e;n={},r.search&&(n.params=o(r.search));for(t in r)e=r[t],n[t]=e;return this.match(r.pathname,n)},r.prototype.scan=function(r,n){var e,a,o,u,p,f,c,l,s;if(c=i(n),e=c.exec(r),null==e)return!1;for(p=t(n),f={},e.shift(),a=l=0,s=p.length;s>l;a=++l)u=p[a],f[u]=e[a];return o={params:f}},r.prototype.namespace=function(r,t){var n,e;return e=this,n={map:function(t,n){return e.map(r+t,n)}},t.call(n)},r}(),t!==void 0&&null!==t?("undefined"!=typeof module&&null!==module&&null!=module.exports&&(t=module.exports=r),t.Cartograph=r):"function"==typeof define&&define.amd?define(function(){return r}):this.Cartograph=r}).call(this);