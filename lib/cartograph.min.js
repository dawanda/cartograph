(function(){var r,t;r=function(){function r(r){"function"==typeof r&&this.draw(r)}var t,n,e,a,o,u,p,i;return n=/:([\w\d]+)/g,i=/\*/g,o=function(r){var t,n;return t="([^/]+)",n=".*",u(r,t,n)},p=function(r){var t,n;return t="[^/]+",n="(.*)",u(r,t,n)},u=function(r,t,e){var a;return a=/[\-{}\[\]+?.,\\\^$|#\s]/g,r=r.replace(a,"\\$&").replace(n,t).replace(i,e),RegExp("^"+r+"$","i")},t=function(r){var t,n,e,a;for(n=/[:|\*]([\w\d]+)/g,a=[];t=n.exec(r);)a.push(e=t[1]);return a},e=function(r){var t,n,e;if(n={},null!=r)for(e=/[\?&]([^=&]+)=?([^&$]+)?/g;t=e.exec(r);)n[t[1]]=t[2];return n},a="",r.prototype.draw=function(r){return r.call(this)},r.prototype.map=function(r,t){var n;if(null==(n=this.mappings)&&(this.mappings=[]),"string"!=typeof r)throw Error("route must be a string");if("function"!=typeof t)throw Error("callback must be a function");return this.mappings.push({route:a+r,callback:t})},r.prototype.match=function(r,t){var n,e,a,o,u,p,i,l,s;for(l=this.mappings,s=[],p=0,i=l.length;i>p;p++){if(e=l[p],a=this.scan(r,e.route)){if(null!=t){o=t.params,delete t.params;for(n in t)u=t[n],a[n]=u;if(null!=o&&null==a.params)a.params=o;else for(n in o)u=o[n],a.params[n]=u}e.callback(a);break}s.push(void 0)}return s},r.prototype.matchRequest=function(r){var t,n,a;null==r&&(r=window.location),n={},null!=r.search&&(n.params=e(r.search));for(t in r)a=r[t],n[t]=a;return this.match(r.pathname,n)},r.prototype.scan=function(r,n,e){var a,u,i,l,s,c,f,m,h,g,d;if(null==e&&(e={}),c=e.param_regexp||o(n),e.param_regexp=c,!c.test(r))return!1;for(h=e.splat_regexp||p(n),e.splat_regexp=h,l=c.exec(r),m=h.exec(r),s=e.param_names||t(n),e.param_names=s,f={},a=g=0,d=s.length;d>g;a=++g)i=s[a],f[i]=l[a+1];return f.splats=m.slice(1),u={params:f}},r.prototype.namespace=function(r,t){var n;return n=a,a+=r,t.call(this),a=n},r}(),t!==void 0&&null!==t?("undefined"!=typeof module&&null!==module&&null!=module.exports&&(t=module.exports=r),t.Cartograph=r):"function"==typeof define&&define.amd?define(function(){return r}):this.Cartograph=r}).call(this);